<!DOCTYPE html>
<html lang="en">
    <head>
        <title>TR Team Guidance</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    </head>
    <style>
        
        span {
            font-size:20px;
        }

    </style>
    <script type="text/javascript"> 
            function solution() {
                var hour = new Date().getHours();
                let day = new Date();
                var NOAM_holiday = new Set(["2022/7/1", "2022/7/4", "2022/8/1", "2022/9/5", "2022/10/10", "2022/11/24", "2022/11/25", "2022/12/23", "2022/12/26"]);
                
                const s1 = '*Email Mooncake Support Team (gcmcfte@microsoft.com) and Mooncake TA (mcpodta@microsoft.com)<br>';
                const s2 = '*Email US V-team (usmcall@microsoft.com) and US On-Duty Manager (asimamreqms@microsoft.com)<br>';
                const s3 = '*Call Mooncake Team On-call: +86 13501686912<br>';
                
                if (hour >= 8 && hour < 22) {
                    document.getElementById('sol').innerHTML = 'Please contact China Team:<br>'+s1;
                } else {
                    if (hour < 8) {
                        day.setDate(day.getDate()-1);
                    }
                    var formatted_day = day.getFullYear()+"/"+(day.getMonth()+1)+"/"+day.getDate();
                    if (NOAM_holiday.has(formatted_day)) {
                        document.getElementById('sol').innerHTML = 'Please contact the on-call manager AND Email China Team:<br>'+s3+s1;
                    } else {
                        document.getElementById('sol').innerHTML = 'China Mooncake Team is off work, please contact US Team AND Email China Team:<br>'+s2+s1;
                    }


                }

            }
            
            function display_c(){
                var refresh=1000; // Refresh rate
                mytime=setTimeout('display_ct()',refresh)
            }

            function display_ct() {
                var x = new Date();   
                document.getElementById('ct').innerHTML = x;
                display_c();
                solution();
            }  
            
    </script>
    
    <body onload="display_ct()">
        <h1>For TR Team: Mooncake Team Contact Guide</h1>
        <div class="container">
            <div class="alert alert-danger">
            <strong>Please Note:</strong> Access is restricted to TR Team ONLY. Please do not share as this feature will not work for anyone outside the group. 
            </div>
            
            <h2>Current Time</h2>
            <div class="panel-group">
                <div class="panel panel-primary">
                    <div class="panel-heading">Current Time</div>
                    <div class="panel-body" id='ct'></div>
                </div>
                
                <h2>Your Action</h2>
                <div class="panel panel-success">
                    <div class="panel-heading">Your Action</div>
                    <div class="panel-body" id='sol'></div>
                </div>
            
            </div>
            
            
        </div>
        

                
    </body>
</html>
