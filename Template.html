<!DOCTYPE html>
<html>
    <head>
        <title>TR Team Guidance</title>
    </head>
    <style>
        p {
            color: red;
            font-size:20px;
            text-transform: uppercase;
            font-weight: bold;
        }
    </style>
    <p>INTERNAL USE ONLY</p>
    <script type="text/javascript"> 
            function solution() {
                var hour = new Date().getHours();
                let day = new Date();
                var NOAM_holiday = new Set(["2022/6/23","2022/7/1", "2022/7/4", "2022/8/1", "2022/9/5", "2022/10/10", "2022/11/24", "2022/11/25", "2022/12/23", "2022/12/26"]);
                
                const s1 = '*Email Mooncake Support Team (gcmcfte@microsoft.com) and Mooncake TA (mcpodta@microsoft.com)<br>';
                const s2 = '*Email US V-team (usmcall@microsoft.com) and US On-Duty Manager (asimamreqms@microsoft.com)<br>';
                const s3 = '*Call Mooncake Team On-call: +86 13501686912<br>';
                
                if (hour >= 8 && hour < 22) {
                    document.getElementById('sol').innerHTML = 'Please contact China Team:<br>'+s1;
                } else {
                    if (hour < 8) {
                        day.setDate(day.getDate()-1);
                    }
                    var formatted_day = day.getFullYear()+"/"+(day.getMonth()+1)+"/"+day.getDate();
                    if (NOAM_holiday.has(formatted_day)) {
                        document.getElementById('sol').innerHTML = 'Please contact the on-call manager AND Email China Team:<br>'+s3+s1;
                    } else {
                        document.getElementById('sol').innerHTML = 'China Mooncake Team is off work, please contact US Team AND Email China Team:<br>'+s2+s1;
                    }


                }

            }
            
            function display_c(){
                var refresh=1000; // Refresh rate
                mytime=setTimeout('display_ct()',refresh)
            }

            function display_ct() {
                var x = new Date();   
                document.getElementById('ct').innerHTML = x;
                display_c();
                solution();
            }  
            
    </script>
    
    <body onload="display_ct()">
        <h1>For TR Team: Mooncake Team Contact Guide</h1>
        <h2>Current Time</h2>
        
        <span id='ct' ></span>
        <h2>Your Solution</h2>
        <span id='sol'></span> 
                
    </body>
</html>
